$(document).ready(function(){var captcha_dirty=!0;var lastresp=null;var lastview=0;$body=$("body");$(document).on({ajaxStart:function(){$body.addClass("loading")},ajaxStop:function(){$body.removeClass("loading")}});var gcharts_loaded=!1;function loadGoogleCharts(func,data)
{lastview=0;if(gcharts_loaded==!1){if(typeof google_charts_url=='undefined'){var google_charts_url='https://www.gstatic.com/charts/loader.js'}
$.getScript(google_charts_url,function(d,textStatus,jqxhr){google.charts.load("current",{packages:['corechart','table']});google.charts.setOnLoadCallback(function(){gcharts_loaded=!0;func(data)})})}else{func(data)}}
var default_timeout=60000;$(function(){$('[data-toggle="tooltip"]').tooltip()});function get_eiin_finder(ftype){var eiin_finder='';var eiin_finder_suffix='';if(ftype=='tbl'){eiin_finder=eiin_finder_tbl_url}else if(ftype=='tree'){eiin_finder=eiin_finder_tree_url}
if(eiin_finder!=''){var board=$('#board').val();var exam=$('#exam').val();var year=$('#year').val();if(board==''||exam==''||year==''){bsalert('Please choose Exam, Year, Board first.');return!1}
eiin_finder=eiin_finder+'?board='+board+'&exam='+exam+'&year='+year;eiin_finder=eiin_finder+eiin_finder_suffix;if(typeof btree_url!=='undefined'){var prefix=window.location.pathname.match(/.*\//)[0];eiin_finder=eiin_finder+'&url='+prefix+btree_url}
window.open(eiin_finder,'inst_finder')}else{bsalert('Institution Finder is not configured!');return!1}
return eiin_finder}
$('#eiin_finder_tree').on('click',function(){get_eiin_finder('tree')});$('#eiin_finder_tbl').on('click',function(){get_eiin_finder('tbl')});function show_result_type(div){var val=$(div).val();var arows=['roll','reg','eiin','dcode','ccode'];var common=['captcha','submit'];if(val==''){for(var i in arows){field="#row_"+arows[i];$(field).hide()}
for(var i in common){field="#row_"+common[i];$(field).hide()}
return}
for(var i in common){field="#row_"+common[i];$(field).show()}
if(captcha_url==""){$('#row_captcha').hide();$('#captcha').prop('required',!1)}else{$('#captcha').prop('required',!0)}
var rdiv={1:{"roll":{"required":"true"},"reg":{"required":"false"},},2:{"eiin":{"required":"true"},},3:{"roll":{"required":"true"},},4:{"dcode":{"required":"true"},"ccode":{"required":"true"},},5:{"dcode":{"required":"true"},},6:{"eiin":{"required":"true"},},7:{},8:{},}
var hdivs=[];for(var i in rdiv){if(i==val){sdiv=rdiv[i]}else{hdivs.push(rdiv[i])}}
var hhdiv={};for(var i in hdivs){key=hdivs[i];for(var j in key){hhdiv[j]=key[j]}}
var hdiv={};for(var i in hhdiv){if(!(i in sdiv))hdiv[i]=hhdiv[i]}
var field,required;for(var i in sdiv){field="#row_"+i;required=sdiv[i].required;$(field).show();if(required=="true")$('#'+i).prop('required',!0);else $('#'+i).prop('required',!1)}
for(var i in hdiv){field="#row_"+i;required=hdiv[i].required;$(field).hide();$('#'+i).prop('required',!1)}
var tdiv='';tdiv+='<div class="text-center">';tdiv+='<div class="btn-group">';tdiv+='<button type="button" class="btn btn-info search-button" id="search">Search Again</button>';tdiv+='<button type="button" class="btn btn-success print-button" id="printbtn" onclick="window.print();">Print</button>';if(val=='2'||val=='4'||val=='5'){tdiv+='<button type="button" class="btn btn-primary download-button" id="download">Download Result (PDF)</button>';tdiv+='<button type="button" class="btn btn-danger view-button" id="view_pdf">View Result (PDF)</button>'}
if(val=='6'||val=='7'){tdiv+='<button type="button" class="btn btn-warning toggle-button" id="toggle_view">Toggle View</button>'}
if(val=='7'){tdiv+='<button type="button" class="btn btn-danger tree-button" id="view_tree">View Board Tree (SVG)</button>'}
tdiv+='</div>';tdiv+='</div>';$('.buttons').html(tdiv)}
$("#exam").change(function(){handle_changes()});$("#year").change(function(){handle_changes()});$("#board").change(function(){handle_changes()});$("#result_type").change(function(){handle_changes();var rtval=$('#result_type').val();if(rtval=='4'){var dcode=$('#dcode').val();if(dcode!='')dcode_changed()}
show_result_type('#result_type');get_captcha('captcha_img')});$("#dcode").change(function(){dcode_changed()});function dcode_changed(){var cdiv='#ccode';$(cdiv).empty();$(cdiv).append($('<option>').text('Choose One').attr('value',''));last_cent_key='';var rtval=$('#result_type').val();if(rtval!='4'){return}
var exam=$('#exam').val();if(exam=='')return;var year=$('#year').val();if(year=='')return;var board=$('#board').val();if(board=='')return;var dcode=$('#dcode').val();if(dcode=='')return;load_cent_list(exam,year,board,dcode)}
function handle_changes(){update_result_svc_vars();var rtval=$('#result_type').val();if(rtval=='4'||rtval=='5'){var exam=$('#exam').val();if(exam=='')return;var year=$('#year').val();if(year=='')return;var board=$('#board').val();if(board=='')return;load_dist_list(exam,year,board)}}
var last_dist_key='';var last_cent_key='';function load_dist_list(exam,year,board){var dist_key=exam+year+board;if(last_dist_key==dist_key){return}
if(typeof dist_list_url=='undefined'){var dist_list_url='list?id=dlist'}
var url=dist_list_url+(dist_list_url.indexOf('?')==-1?'?':'&')+'board='+board+'&exam='+exam+'&year='+year;var data=null;var params=dist_key;get_ajax(url,data,populate_dist,fail_func,"get","json",params)}
function populate_dist(resp,params){last_dist_key=params;var div='#dcode';var cdiv='#ccode';$(div).empty();$(div).append($('<option>').text('Choose One').attr('value',''));$(cdiv).empty();$(cdiv).append($('<option>').text('Choose One').attr('value',''));$.each(resp,function(i,kv){$(div).append($('<option>').text(kv.name+' - '+kv.code).attr('value',kv.code))})}
function load_cent_list(exam,year,board,dcode){var cent_key=exam+year+board+dcode;if(last_cent_key==cent_key){return}
if(typeof cent_list_url=='undefined'){var cent_list_url='list?id=clist'}
var url=cent_list_url+(cent_list_url.indexOf('?')==-1?'?':'&')+'board='+board+'&exam='+exam+'&year='+year+'&dcode='+dcode;var data=null;var params=cent_key;get_ajax(url,data,populate_cent,fail_func,"get","json",params)}
function populate_cent(resp,params){var div='#ccode';$(div).empty();$(div).append($('<option>').text('Choose One').attr('value',''));$.each(resp,function(i,kv){$(div).append($('<option>').text(kv.name+' - '+kv.code).attr('value',kv.code))})}
function update_result_svc_vars(){var result_exam=$('#exam').val();var result_year=$('#year').val();var result_type=$('#result_type').val();if(typeof extsvc!=='undefined'){if(extsvc.exam==result_exam&&extsvc.year==result_year){result_url=result_svc_url;result_method=result_svc_method;captcha_url=extsvc.captcha;if(extsvc.type==0||extsvc.type==result_type){result_url=extsvc.url;result_method=extsvc.method}}else{captcha_url=captcha_svc_url;result_url=result_svc_url;result_method=result_svc_method}
if(result_type!=''){if(captcha_url==""){$('#row_captcha').hide();$('#captcha').prop('required',!1);captcha_dirty=!0}else{$('#row_captcha').show();$('#captcha').prop('required',!0);get_captcha('captcha_img')}}}}
function get_result_method(type,resp,exam,year){var method;switch(type){case '1':method=show_stud_result(resp,exam,year);break;case '2':method=show_inst_result(resp);break;case '3':method=show_testimonial(resp);break;case '4':method=show_cent_result(resp);break;case '5':method=show_dist_result(resp);break;case '6':method=show_inst_result_stat(resp);break;case '7':method=show_board_result_stat(resp);break;default:break}
if(typeof resp.stat_url==='undefined')resp.stat_url='';if(resp.stat_url!=''){get_ajax(resp.stat_url)}
return method}
function bsalert(msg){var dialogId='server-message-dialog';var dialog=new BootstrapDialog({id:dialogId,type:BootstrapDialog.TYPE_PRIMARY,title:'Message from Server',message:msg,buttons:[{id:'btn-ok',icon:'glyphicon glyphicon-check',label:' OK',cssClass:'btn-primary',autospin:!1,action:function(dialogRef){dialogRef.close()}}]});dialog.open()}
$(".buttons").hide();$(document).on('click',".search-button",function(){$(".panel").show();$("#captcha_img").attr("src","");$("#captcha").val("");captcha_dirty=!0;$("#result_type").val("");show_result_type('#result_type');$("#result_display").empty().hide();$("#page-header").empty();$(".buttons").hide();$("#testimonial").remove()});function get_exam(exam){var name='';switch(exam){case 'jsc':name="JSC or Equivalent";break;case 'ssc':name="SSC or Equivalent";break;case 'hsc':name="HSC or Equivalent";break;case 'dibs':name="DIBS";break;default:break}
return name}
function get_captcha(id){if(captcha_dirty!=!0)return;$("#"+id).attr("src","");var unique=$.now();if(captcha_url!=""){var url=captcha_url+"?t="+unique;$("#"+id).attr("src",url);captcha_dirty=!1}else{captcha_dirty=!0}}
$('#captcha_reload').on('click',function(){captcha_dirty=!0;get_captcha('captcha_img')});$('#form').on('submit',function(e){e.preventDefault();var data=$(this).serializeArray();var result_type=$('#result_type').val();var exam=$("#exam").val();var year=$("#year").val();var params={'exam':exam,'year':year,'result_type':result_type};if(result_type=='3'){if(!check_chrome()){return!1}}
get_ajax(result_url,data,result_success,fail_func,result_method,"json",params)});function get_ajax(url,data,success_fun,fail_fun,type,dataType,params,timeout){if(!url)return!1;type=(type)?type:"get";data=(data)?data:"";dataType=(dataType)?dataType:"";timeout=(timeout)?timeout:default_timeout;params=(params)?params:"";$.ajax({url:url,type:type,dataType:dataType,data:data,timeout:timeout,}).done(function(resp){if(success_fun)success_fun(resp,params)}).fail(function(params){if(fail_fun)fail_fun(params)})}
function result_success(resp,params){if(resp.status==0){get_result_method(params.result_type,resp,params.exam,params.year);if(params.result_type!=3){var exam_name=get_exam(params.exam);var header_txt="<h3>Result of "+exam_name+" Examination - "+params.year+"</h3>";$("#page-header").html(header_txt)}}else{bsalert(resp.msg);$("#captcha").val("");captcha_dirty=!0;get_captcha("captcha_img")}};function inst_success(resp,params){if(resp.status==0){$(params).html(resp.res.i_name)}else{str="Institute Name not loaded properly";err_info(str)}};function sub_success(resp,params){display_sub(resp,params.codes,params.subs)};function fail_func(data){bsalert("Error getting information from server. Please check and try again.")};function inst_fail(data){str="Institute Name not loaded properly";err_info(str)};function sub_fail(){str="Subject Name not loaded properly";err_info(str)}
function show_cent_result(resp){return show_inst_result(resp)}
function show_dist_result(resp){return show_inst_result(resp)}
function show_inst_result(resp){$(".panel").hide();$("#result_display").show();$(".buttons").show();var extra=resp.extra;var path='';var download='';var view='';var tree='';if(typeof extra.download==='undefined'){extra.download=''}
var prefix=window.location.pathname.match(/.*\//)[0];download=path+prefix+extra.download;if(typeof extra.view==='undefined'){extra.view=''}
view=path+extra.view+prefix+extra.download;var tdiv='';tdiv+=extra.content;tdiv+='<hr/>';$("#result_display").append(tdiv);$('.download-button').on('click',function(e){if(download!=''){window.open(download,'dl_pdf')}else{bsalert('PDF version of result is not available.')}});$('.view-button').on('click',function(){if(view!=''){window.open(view,'inst_pdf')}else{bsalert('PDF version of result is not available.')}})}
function show_inst_result_stat(resp)
{if(typeof resp.extra.tree==='undefined'){tree=''}else{tree=resp.extra.tree}
if(typeof btree_url!=='undefined'){var prefix=window.location.pathname.match(/.*\//)[0];tree=tree+'?url='+prefix+btree_url}
$('.tree-button').on('click',function(){if(tree!=''){window.open(tree,'board_tree')}else{bsalert('Board Tree is not available.')}});$('.toggle-button').on('click',function(){if(lastresp){lastview^=1;google_charts_draw(lastresp,lastview)}});var extra=resp.extra;var rd=$('#result_display');var tdiv=extra.content;rd.append(tdiv);$.each(resp.extra.charts,function(i,v){rd.append('<div id="'+v.id+'"></div>')});loadGoogleCharts(google_charts_draw,resp);tdiv='<hr/>';rd.append(tdiv);lastresp=resp}
function google_charts_draw(resp,alt=0)
{$(".panel").hide();$("#result_display").show();$(".buttons").show();var rd=$('#result_display');var extra=resp.extra;if(typeof extra.charts=='undefined'||extra.charts=='')return;var charts=extra.charts;if(alt==1){if(typeof extra.charts_alt=='undefined'||extra.charts_alt=='')return;charts=extra.charts_alt}
$.each(charts,function(i,v){var draw=1;var dtbl=google.visualization.arrayToDataTable(v.data);cdiv=$('#'+v.id);var opts={title:v.title,};if(v.type=="pie"){if(typeof v.attr!='undefined'&&v.attr=="3d"){opts.is3D=!0}
var chart=new google.visualization.PieChart(document.getElementById(v.id))}else if(v.type=="bar"){if(typeof v.attr!='undefined'&&v.attr=="stacked"){opts.isStacked=!0}
var chart=new google.visualization.BarChart(document.getElementById(v.id))}else if(v.type=="table"){opts.showRowNumber=!0;opts.width='100%';opts.height='100%';var chart=new google.visualization.Table(document.getElementById(v.id))}else{draw=0}
if(draw==1){chart.draw(dtbl,opts);if(v.type=="table"){var caption=document.createElement("caption");var caption_text=document.createTextNode(opts.title);caption.appendChild(caption_text);var table_object=document.getElementById(v.id).firstChild.firstChild.firstChild;table_object.insertBefore(caption,table_object.firstChild)}}})}
function show_board_result_stat(resp){return show_inst_result_stat(resp)}
function show_board_result_tree(resp){return!1}
var err_div="#err_msg";function err_info(str){if(str!=''){$(err_div).append('<br/>:: '+str);unhide_info()}}
function empty_info(notice){$(err_div).empty();$(err_div).hide();if(notice!=''){$(err_div).append(notice);unhide_info()}}
function unhide_info(){$(err_div).show()}
function resolve_eiin(url,div){var params=div;get_ajax(url,'',inst_success,inst_fail,"get","json",params)}
function resolve_sub(url,codes,subs){var params={'codes':codes,'subs':subs};get_ajax(url,'',sub_success,sub_fail,"get","json",params)}
function display_sub(sub,codes,subs){var sub_code,sub_name;var sub_arr=[];for(var i in codes){var code=codes[i];for(var j in sub){sub_code=sub[j].SUB_CODE;sub_name=sub[j].SUB_NAME;for(var k in code){if(code[k]==sub_code){sub_arr[sub_code]=sub_name}}}}
for(var i in subs){var scode=subs[i];var sname=scode.replace(/\d+/g,function(m){return sub_arr[m]});if(sname==='undefined')sname='';var div_id=".code_"+subs[i].replace('<br>','_');$(div_id).html(sname)}}
function show_stud_result(resp,exam,year){var tdiv='';$(".panel").hide();$("#result_display").show();$(".buttons").show();var res=resp.res;var father_name="Father's Name";var mother_name="Mother's Name";if(typeof res.stud_group==='undefined'){res.stud_group="N/A"}
if(typeof res.dob==='undefined'||res.dob==''){res.dob="N/A"}
if(typeof res.stud_sex==='undefined'){if(typeof res.sex==='undefined'){res.stud_sex='N/A'}else{var sex_str=String(res.sex);var sex_desc='';switch(sex_str.charAt(0).toUpperCase()){case '0':case 'M':sex_desc='Male';break;case '1':case 'F':sex_desc='Female';break;default:sex_desc='N/A';break}
res.stud_sex=sex_desc}}
tdiv+='<div class="table-responsive">';tdiv+='<table class="table table-striped table-bordered" width="100%"><tbody>';tdiv+='<tr><td>Roll No</td><td>'+res.roll_no+'</td><td>Registration No</td><td>'+res.regno+'</td></tr>';tdiv+='<tr><td>Name of Student</td><td colspan="3">'+res.name+'</td></tr>';tdiv+='<tr><td>'+father_name+'</td><td colspan="3">'+res.fname+'</td></tr>';tdiv+='<tr><td>'+mother_name+'</td><td colspan="3">'+res.mname+'</td></tr>';tdiv+='<tr><td>Board</td><td>'+res.board_name+'</td><td>Session</td><td>'+res.session+'</td></tr>';tdiv+='<tr><td>Group</td><td>'+res.stud_group+'</td><td>Type: '+res.stud_type+'</td><td>Gender: '+res.stud_sex+'</td></tr>';tdiv+='<tr><td>Result</td><td>'+res.res_detail+'</td><td>Date of Birth</td><td>'+res.dob+'</td></tr>';tdiv+='<tr><td>Name of Institute</td><td colspan="3"><span id="i_name">'+(typeof res.inst_name!=='undefined'?res.inst_name:res.eiin)+'</span></td></tr>';tdiv+='</tbody></table>';var all_disp=[];var all_disp_title=[];if(res.display_details){all_disp.push(res.display_details);all_disp_title.push('Subject-Wise Grade/Marks')}
if(res.display_details_ca){all_disp.push(res.display_details_ca);all_disp_title.push('Subject-Wise Grade/Marks for Continuous Assessment')}
tdiv+='<div class="alert alert-info text-center" id="err_msg" style="display:none"></div>';var subs=[];var codes=[];for(var ai in all_disp){var display_details=all_disp[ai];var display_details_title=all_disp_title[ai];var marks=display_details.split(',');var have_marks=marks.length>=1&&marks[0].split(':').length>1;var have_marks_details=marks[0].split('=').length>1;if(have_marks){var colspan,mrks_split,code,grade,total,mrks_dtls;tdiv+='<div class="text-center"><h4>'+display_details_title+'</h4></div>';var span='';if(resp.showmarks==1&&have_marks_details){span=' rowspan="2" '}
tdiv+='<table class="table table-striped table-bordered" width="100%">';tdiv+='<thead class="btn-success"><tr><th'+span+'>Subject Code</th><th'+span+' >Subject Name</th>';if(resp.showmarks==1&&have_marks_details){if(resp.totalonly!=1){colspan=4}else{colspan=1}
tdiv+='<th colspan="'+colspan+'">Marks</th>'}
var grd_title='Grade/Marks';if(typeof grd_start_config!=='undefined'&&typeof grd_start_config[exam]!=='undefined'){if(Number(year)>=Number(grd_start_config[exam])){grd_title='Grade'}else{grd_title='Marks'}}
tdiv+='<th'+span+'>'+grd_title+'</th></tr>';if(resp.showmarks==1&&resp.totalonly!=1&&have_marks_details){tdiv+='<tr><th>Theory</th><th>Practical</th><th>MCQ</th><th>Total</th></tr>'}
tdiv+='</thead><tbody>';for(var i in marks){mrks_dtls='';total='';mrks_split=marks[i].split(':');if(mrks_split.length==1)continue;code=mrks_split[0].trim();if(code=='')continue;result=mrks_split[1];result_split=result.split('=');count=result_split.length;grade=result_split[count-1].trim();if(count>2){mrks_dtls=result_split[0];total=result_split[1]}else if(count>1){mrks_dtls='';total=result_split[0]}else{total='';mrks_dtls=''}
if(grade=='F'){mrks_dtls=total=''}
if(resp.showmarks==1&&resp.totalonly!=1&&have_marks_details){var mrks=mrks_dtls.split('-');var theory='';var prac='';var mcq='';var t=[];var p=[];var m=[];for(var n=0;n<mrks.length;n++){ms=mrks[n].split('+');t.push(ms[0]);p.push(ms[1]);m.push(ms[2])}
theory=t.join('<br>');prac=p.join('<br>');mcq=m.join('<br>')}
var code_splt=code.split(/[\+\-]/);var scode=code_splt.join('<br>');subs.push(scode);codes.push(code_splt);var sname='<span class="code_'+scode.replace('<br>','_')+'"></span>';tdiv+='<tr><td class="cent-align">'+scode+'</td><td>'+sname+'</td>';if(resp.showmarks==1&&have_marks_details){if(resp.totalonly!=1){tdiv+='<td class="right-align">'+theory+'</td><td class="right-align">'+prac+'</td><td class="right-align">'+mcq+'</td>'}
tdiv+='<td class="right-align">'+total+'</td>'}
tdiv+='<td class="cent-align">'+grade+'</td></tr>'}
tdiv+='</tbody></table>'}
tdiv+='<div class="divpadding"></div></div>'}
$("#result_display").append(tdiv);if(typeof resp.notice==='undefined')resp.notice='';empty_info(resp.notice);if(typeof resp.sub_details!=='undefined'){display_sub(resp.sub_details,codes,subs)}else if(typeof resp.sub!=='undefined'){resolve_sub(resp.sub,codes,subs)}
if(typeof resp.eiin_url!=='undefined'){resolve_eiin(resp.eiin_url,'#i_name')}}
function get_ucfirst(str){str=str.toLowerCase();return str.ucfirst()}
String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.substr(1)}
var check_browser=function(){var browser="";if(navigator.userAgent.toLowerCase().indexOf('firefox')>-1)browser='firefox';if(navigator.userAgent.toLowerCase().indexOf('chrome')>-1)browser='chrome';if(navigator.userAgent.toLowerCase().indexOf('opr')>-1)browser='opera';return browser}
function check_chrome(){var browser=check_browser();if(browser!='chrome'){bsalert("Please Use Google Chrome browser for testimonial. You can download Google Chrome browser from <a href=\"https://www.google.com/chrome/browser/desktop/index.html\" target=\"_blank\">Here</a>.");return!1}
return!0}
function show_testimonial(resp){if(typeof testimonial_css_url=='undefined'){var testimonial_css_url='/app/stud/allcss/testimonial.css'+'?t='+Date.now()}
loadcss(testimonial_css_url,'testimonial');var res=resp.res;res.board_name=get_ucfirst(res.board_name);res.center=get_ucfirst(res.center);res.stud_gender_his_upper=res.stud_gender_his.ucfirst();res.stud_gender_he_upper=res.stud_gender_he.ucfirst();var tmpl=resp.template;var regex=/\{\{ ([^\} ]+) \}\}/g;var match=tmpl.matchAll(regex);for(var i in match){var key=match[i][1];var search='{{ '+key+' }}';var replace=res[key];tmpl=tmpl.replace(search,replace)}
var obj={"header":"true","content":tmpl,"id":"mymodal",};$('.panel').hide();$('#result_display').show();$('.buttons').show();$('#result_display').append(tmpl)}
function loadcss(href,id){var cssLink=$("<link rel='stylesheet' type='text/css' href='"+href+"' id='"+id+"'>");$("head").append(cssLink)}
function loadjs(src,postfunc,data){$.getScript(src,function(data,textStatus,jqxhr){postfunc(data)})}
function get_modal(obj){var ret='';ret+='<div id="'+obj.id+'" class="modal fade" role="dialog">';ret+='<div class="modal-content">';if(obj.header=='true'){ret+='<div class="modal-header">';ret+='<button type="button" class="close" data-dismiss="modal">&times;</button>';ret+='</div>'}
ret+='<div class="modal-body">';ret+=obj.content;ret+='</div>';ret+='</div>';ret+='</div>';return ret}
String.prototype.matchAll=function(regexp){var matches=[];this.replace(regexp,function(){var arr=([]).slice.call(arguments,0);var extras=arr.splice(-2);arr.index=extras[0];arr.input=extras[1];matches.push(arr)});return matches.length?matches:null}})